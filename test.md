---
substitutions: test
---

(biophysical-spike-generators-the-hodgkin-huxley-neuron)=

# Biophysical Spike Generators:    The Hodgkin-Huxley Neuron

(sec:bionets)=

## Introduction to Modeling Biological Neurons

(historical-timeline)=

### Historical Timeline

(the-core-of-the-brains-functional-organization)=

#### The Core of the Brain's Functional Organization

The biology of nerve cells is grounded in three principles that
represent the core of the brain's functional organization:

1.  The *neuron doctrine*: the nerve cell or neuron is the fundamental
    building block and elementary signaling unit in the brain.

2.  The *ionic hypothesis*: individual nerve cells generate electrical
    signals, called action potentials, that can propagate over
    considerable distance within a given nerve cell.

3.  The *chemical theory of synaptic transmission*: a nerve cell
    communicates with another by releasing a chemical signal called a
    neurotransmitter; the second cell recognizes the signal and responds
    by means of a specific molecule in its surface membrane called a
    receptor.

(electrical-signaling-as-the-language-of-the-mind)=

#### Electrical Signaling as the Language of the Mind

*Morphology* deals with the form and structure of neurons without
consideration of function. Electrical *signaling* is the means by which
nerve cells communicate with each other. In short, electrical signaling
is the language of communication of the mind.

Historically, the (electrical) signaling function of neurons was
investigated in the last 200 years and proceeded over four phases: (i)
discovery of electrical activity and its speed of propagation in
animals, (ii) study of the form of the signaling activity and its role
in encoding information, (iii) postulation of the membrane hypothesis,
and (iv) postulation and verification of the ionic hypothesis. These are
described in more detail below.

(electrical-activity-and-its-speed-of-propagation-in-animals)=

#### Electrical Activity and its Speed of Propagation in Animals

In 1791 Luigi Galvani (i) discovered electrical activity in animals and
(ii) brought nervous system activity out of the realm of vital forces
and into the natural sciences.

By 1859 Hermann von Helmholtz (i) brought the rigorous methods of
physics into brain science and (ii) succeeded in measuring the speed at
which electrical messages are conducted. He found that electricity
conducted along a living axon is fundamentally different from the flow
of electricity in a copper wire.

Subsequently, it was demonstrated that nerves sacrifice speed of
conduction for active regeneration.

(form-of-the-signal-and-its-role-in-encoding-information)=

#### Form of the Signal and its Role in Encoding Information

Edgar Douglas Adrian (1920s) argued that

-   *action potentials* are all-or-none events that encode information
    about the stimulus,

-   action potentials generated by the same cell exhibit about the same
    shape and amplitude regardless of the strength, duration and
    location of the stimulus,

-   stimulus intensity results from the frequency with which action
    potentials are emitted,

-   the nature of information conveyed depends on the type of nerve
    fibers that are activated and the specific brain systems to which
    those fibers are connected.

    Thus, visual information is different from auditory information
    because it activates different pathways.

(the-membrane-hypothesis)=

#### The Membrane Hypothesis

Julius Bernstein following up on his Ph.D. thesis of 1902

-   determined that the *potential difference across the cell membrane*
    is about -70 mV,

-   postulated that in resting state, the membrane presents a barrier to
    all ions except one - potassium (see {numref}`fig:bernstein`). As
    potassium moves out of the cell, it is drawn back by the positive
    charge left behind. The resulting ion balance maintains the membrane
    potential at -70 mV.

-   the selective permeability of the cell membrane breaks down very
    briefly during the action potential, allowing all ions to enter and
    leave the cell freely and reducing the resting membrane potential to
    *zero*.

```{figure} ../figures/chap_02/images/bernstein.pdf
:name: fig:bernstein
:width: 80%
Diffusion of $K^+$ ions down the concentration gradient through the
membrane (a) creates an electric potential force directed in the
opposite direction (b) until the diffusion and electrical forces counter
each other (c).
```

(the-ionic-hypothesis)=

#### The Ionic Hypothesis

Allan Hodgkin and Andrew Huxley in a series of publications in 1952

-   confirmed Bernstein's inference that the action potential was about
    -70 mV and that it depends on the movement of potassium ions through
    ion channels,

-   discovered that the amplitude of the action potential is 110 mV and
    not 70 mV as predicted by Bernstein,

-   concluded that Bernstein's hypothesis that the action potential
    represents a generalized breakdown of the cell membrane's
    permeability to all ions had to be incorrect.

(ion-channels)=

### Ion Channels

The *cell membrane* provides a boundary separating the internal working
of the cell from its external environment. It consists of a lipid
bylayer about 7.5 nm thick that is a very strong insulator. The membrane
contains transmembrane proteins that form pores facilitating the
transport of water and ions across the cell membrane. The channels of
these pores are, respectively, called water and *ion channels*.

Ion channels undergo conformational changes that allow ion passage (gate
open) or prohibit ion passage (gate closed). In addition to ion
channels, *ion pumps* are also embedded in the cell membrane. The ion
pumps tap into the energy generated in the cell and use it for ion
transport across the cell membrane, e.g., from the inside of the cell to
the outside of the cell (and vice versa). The energy source of ion
movement is the ionic concentration gradient across the membrane. This
gradient is maintained by the active transport of the ion pumps and the
passive distribution of ions.

There are four ion channel types in the nervous system: (i) sodium
($Na^{+}$), (ii) potassium ($K^{+}$), (iii) calcium ($Ca^{{2+}}$) and
(iv) chloride ($Cl^{-}$). For these ion types, the concentration
difference between the inside of the cells and its surrounding fluid is
established by the ion pumps. For example, for sodium the concentration
inside of the cell is 50 mM while the concentration outside of the cell
is 440 mM. For potassium the concentration is higher inside, 400 mM, and
lower outside, 20 mM. See also {numref}`fig:nernst`.

(graded-and-action-potentials)=

### Graded and Action Potentials

Neural signals, either electrical or chemical, are the messengers used
by the nervous system for all of its functions. Electric signals in
excitable membranes are transmitted from one part of the cell to another
in two ways, by:

-   passive spread of *graded potentials*. Graded (analog) potentials
    are:

    -   observed in interneurons that transmit signals over short
        distances,

    -   carried by ions that diffuse down their electrochemical
        gradients. The magnitude of the signal varies with the intensity
        of the ion currents.

-   propagation of all-or-none *action potentials*. Action potentials
    (spikes) are

    -   used by neurons that bear far-reaching processes (axons),
        carrying signals over long distance,

    -   carried by voltage- and time-dependent conductances that
        generate transient all-or-none potential changes (spikes).

(the-equilibrium-potential)=

## The Equilibrium Potential

(physical-laws-dictate-ion-movement)=

### Physical Laws Dictate Ion Movement

The principles of ion permeability and channel gating are the
cornerstones of our understanding of neural signaling.

1.  Based on thermodynamic principles, ions tend to flow from regions of
    high concentration to regions of low concentration - a phenomenon
    known as *diffusion*.

2.  Since most plasma membranes are permeable to some ion species but
    not to others, a *separation of charge* occurs. This separation
    results in an electric field across the membrane that influences the
    movement of ions through pore channels situated in the plasma
    membrane.

3.  The concentration differences are caused by active ion transporters
    (ion pumps) and selective permeabilities of ions of the plasma
    membrane.

Since our primary focus is ion movements across the cell membrane, we
assume for simplicity that ions move along the x-axis.

(ficks-law)=

#### Fick's Law

The *diffusion* of particles *caused by a concentration gradient* is
given by

```{math} 
J_{\textit{diff}}=-D \frac{\partial [C]}{\partial x} ,
```
where $J_{\textit{diff}}$ is the diffusion flux
(molecules/s$\cdot$cm$^{2}$), $D$ is the diffusion coefficient
(cm$^{2}$/s), $[C]$ is the concentration of ions (molecules/cm$^{3}$)
and $x$ is the distance (cm).

(ohms-law)=

#### Ohm's Law

The *drift* of ions *caused by an electric field* is given by

```{math} 
J_{\textit{drift}}=\partial_{el} E = -\mu z [C] \frac{\partial V}{\partial x},
```
where $J_{\textit{drift}}$ is the drift flux
(molecules/s$\cdot$cm$^{2}$), $\partial_{el}$ is the electrical
conductivity (molecules/V$\cdot$s$\cdot$cm), $E$ is the electric field
(V/cm), V is the electric potential, $\mu$ is the drift mobility
(cm$^{2}$/V$\cdot$s) and $z$ is the valence of the ion (dimensionless).

(einsteins-relation)=

#### Einstein's Relation

The frictional resistance exerted by the fluid medium at thermal
equilibrium is the same for diffusion and drift processes. This
relationship formally states that the *diffusion and drift processes in
the same medium are additive*. In addition,

```{math} 
D= \frac{kT}{q} \mu ,
```
where k is the Boltzmann's constant (1.38 $\cdot 10^{-23}$
Joule/$^{\circ}$K), $T$ is the absolute temperature ($^{\circ}$K) and
$q$ is the charge (C). Recall that the electrical charge $q$ stored on
the plates of a capacitor amounts to its capacitance times the applied
voltage.

(space-charge-neutrality)=

#### Space-Charge Neutrality

The total charge of cations (positively charged ions) is equal to the
total charge of anions (negatively charged ions) in a given volume. Note
that the charge neutrality breaks down in the plasma membrane. An
example is given below.

```{prf:example} 
*What is the the fraction of uncompensated ions on each side of the
membrane required to produce 100 mV in a spherical cell with a radius of
25 $\mu m$?**Assumptions: the membrane capacitance is $1 \mu F/cm^2$ and
the concentration of ions inside and outside is $0.5$ M (mol/L) The
number of ions needed to charge up 1 $cm^2$ membrane to 100 mV is

```{math} 
\frac{q \cdot 1 (cm^2)}{e} = \frac{10^{-6}(C V^{-1} cm^{-2}) \cdot
10^{-1} (V) \cdot (cm^2)}{1.6 \cdot 10^{-19}(C)} = 6 \cdot 10^{11} .
```
Thus, the total number of uncompensated ions needed for the cell
membrane is

```{math} 
6 \cdot 10^{11} (cm^{-2}) \cdot 4 \pi (0.0025)^2 (cm^2) =
4.7 \cdot 10^7 ,
```
where the second term on the LHS is the surface area of the sphere with
25 $\mu m$ radius. Since the total number of ions in the volume of the
spherical cell is

```{math} 
0.5 ~(mol/L) \cdot 6.02 \cdot 10^{23} / (mol)
\cdot \frac{4}{3} \pi (0.0025)^3 \cdot 10^{-3} (L) = 2\cdot 10^{13},
```
the fraction of uncompensated ions amounts to
$4.7 \cdot 10^7 / 2 \cdot 10^{13}$ or 0.000235%.*
```

(nernst-planck-and-nernst-equations)=

### Nernst-Planck and Nernst Equations

(the-nernst-planck-equation)=

#### The Nernst-Planck Equation

The total ion flux due to the concentration gradient and electric field
amounts to

```{math} 
J= J_{\textit{drift}}+J_{\textit{diff}}= -\mu z [C] \frac{\partial V}{\partial x} - D
 \frac{\partial [C]}{\partial x} .
```
By using Einstein's formula for the diffusion coefficient we obtain the
equation

```{math} 
J=-( \mu z [C] \frac{\partial V}{\partial x} + \frac{\mu kT}{q}
 \frac{\partial [C]}{\partial x}) ,
```
also know as the Nernst-Planck equation. Here $J$ is in
$molecules/s \cdot cm^2$.

The current is the product of the total ion flux and the charge it
carries:

```{math} 
I=J/N_{A} \cdot z F = -(u z^{2} F [C] \frac{\partial V}{\partial x} +
 uz R T \frac{\partial [C]}{\partial x}) ,
```
where $N_{A}$ is Avogadro's number (6.02$\cdot 10^{23}$/mol, number of
elementary particles (molecules, atoms) per mole), R is the gas constant
(8.31 Joule/$^{\circ}$K$\cdot$mol); F is Faraday's constant (96,480
C/mol, the amount of electricity that is carried by 1 mol of electrons);
u is $\mu / N_{A}$: molar mobility (cm$^{2}$/V$\cdot$s$\cdot$mol); and I
is the current density (A/cm$^{2}$). Note that $J/N_{A}$ is the molar
flux and $zF$ is the total molar charge.

(the-nernst-equation)=

#### The Nernst Equation

Under what conditions is the cross-membrane current zero? Since

```{math} 
I=-(u z^{2} F [C] \frac{\partial V}{\partial x} +
uz R T \frac{\partial [C]}{\partial x})=0
```
we obtain

```{math} 
\frac{\partial V}{\partial x}=-\frac{RT}{zF} \frac{1}{[C]}
\frac{\partial [C]}{\partial x} .
```
Therefore, by integrating on $[x_1,x_2]$ on both sides of the cell
membrane

```{math} 
V_{2}-V_{1}=-\frac{RT}{zF} \ln \frac{[C]_{2}}{[C]_{1}} ,
```
that is

```{math} 
V_{in} - V_{out} = \frac{RT}{zF} \ln \frac{[C]_{out}}{[C]_{in}} .
```

(the-nernst-equilibrium-potential)=

### The Nernst Equilibrium Potential

The *equilibrium potential* for ion $i$ is defined as the cross-membrane
potential at which the membrane current carried by ion $i$ equals to
zero:

```{math} 
E_{i}=V_{membrane}(I_{i}=0)=V_{in}-V_{out}=\frac{RT}{zF} \ln \frac{[C]_{out}}{[C]_{in}} .
```

```{prf:example} 
*At room temperature ($T=20 ^{\circ} C = 293.15 ^{\circ} K$) and $z=1$,
the Nernst potential in mV is given by

```{math} 
E_i = 25.23 \cdot \ln \frac{[C]_{out}}{[C]_{in}} = 58 \cdot \log_{10} \frac{[C]_{out}}{[C]_{in}} .
```
In the squid axon, the concentration of potassium is
($[400]_{in}, [20]_{out}$) and sodium\
($[50]_{in}, [440]_{out}$) in mM. Thus, the equilibrium potential is
$-75$ mV for $K^+$ and $55$ mV for $Na^+$ ions.*
```

As shown in the example above, the Nernst potential for sodium
($E_{Na}$) is about +55 mV. If the membrane voltage is smaller than the
value of the Nernst potential $E_{Na}$, more $Na^{+}$ ions flow into the
cell so as to decrease the concentration difference. If the membrane
voltage is larger than the Nernst potential, ions would flow out of the
cell. Therefore, the direction of the current is reversed when the
membrane voltage is larger then $E_{Na}$. This is the reason why the
equilibrium potential $E_{Na}$ is also called the *reversal potential*.
For potassium, the equilibrium or reversal potential is $E_{K}=-75mV$.

```{figure} ../figures/chap_02/images/nernst.pdf
:name: fig:nernst
:width: 80%
Ion concentrations and Nernst equilibrium potentials in a typical
mammalian neuron. $A^-$ are membrane-impermeant anions. Temperature
$T = 37^0 C ~(310.15^0 K)$.
```

The Nernst equilibrium potential is temperature dependent. See
{numref}`fig:nernst` for a range of values of the equilibrium potential
of a typical mammalian neuron at $T = 37^0 C ~(310.15^0 K)$.

(sec:hh)=

## The Hudgkin-Huxley Neuron

Neurons are cells that consist of a cell body or soma, and extensions
called neurites. The neurites are distinguished as *dendrites*, the
receiving end or antennae of the neuron, and an outgoing trunk called
the *axon*. The concentration of ions inside the cell is different from
the concentration of ions outside of it. This difference in
concentration generates a potential difference whose quantitative
characterization will be described next.

(model-of-a-giant-squid-axon-patch)=

### Model of a Giant Squid Axon Patch

The Hodgkin-Huxley model provides a good description of the
electrophysiological properties of a patch of the giant axon of the
squid called the *axon hillock*. For the neurons discussed here, the
axon hillock is located at the "interface" between the soma and the
axon. The model captures the essence of the spike generation of sodium
and potassium ion channels. The basic mechanism is essentially preserved
in higher organisms. Cortical neurons, however, exhibit a much richer
repertoire of electrophysiological properties than the squid axon
studied by Hodgkin and Huxley.

```{figure} ../figures/chap_02/circuits/HHN.pdf
:name: fig:hh model
:width: 60%
The Hodgkin-Huxley model of the giant squid axon hillock.
```

In {numref}`fig:hh model`, the membrane voltage is the potential
difference between the inside and the outside of the cell, the
conductance $g_i$ models the ion channels associated with ion $i$,
$i=K, \textit{Na}, L$, the membrane capacitance $C$ models the
dielectric properties of the membrane bilayer and $E_i$ denotes the
equilibrium potential of ion $i$. $L$ denotes the "leak" $Cl$ ion
channel.

(ionic-currents-and-channel-conductances)=

#### Ionic Currents and Channel Conductances

As mentioned above, $E_{i}$ denotes the Nernst equilibrium potentials
for channel $i$, respectively. The total current $I_i$ through channel
$i$, $i=K, \textit{Na}, L$, amounts to

```{math} 
I_i=g_i (V-E_i),
```
where the positive parameter $g_i$ denotes the *conductance* and
$(V-E_i)$ is the *driving force*. By Kirchhoff's law, the total current
$I$ flowing across a patch of a cell membrane is the sum of the membrane
capacitive current $C \cdot dV/dt$ and all the ionic currents (assuming
that they are independent), i.e.,

```{math} 
I = C \frac{dV}{dt} +I_{Na}+I_{Ca}+I_{K}+I_{Cl}
```
and, by Ohm's law,

```{math} 
I = C \frac{dV}{dt} + g_{Na}(V-E_{Na}) + g_{Ca}(V-E_{Ca}) +
g_{K}(V-E_{K}) + g_{Cl}(V-E_{Cl}) .
```
Note that, for generality, we also added the current flowing through the
calcium channels.

(resting-potential-and-input-conductance)=

#### Resting Potential and Input Conductance

The equivalent "equilibrium" potential amounts to

```{math} 
E_{equiv}= \frac{g_{Na} E_{Na} + g_{Ca} E_{Ca}+ g_K E_K + g_{Cl} E_{Cl}}{g_{Na}+g_{Ca}+g_K+g_{Cl}}.
```
Thus, Kirchhoo's law can be rewritten as

```{math} 
C \frac{dV}{dt} = I - g_{inp}(V-E_{equiv}) ,
```
where

```{math} 
g_{inp}= g_{Na}+g_{Ca}+g_K+g_{Cl}
```
is the *input conductance*. Finally, the *resting membrane potential* is
given by

```{math} 
V_{rest}=E_{equiv}|_{I=0, dV/dt=0} .
```
Typically,

```{math} 
E_K < E_{Cl} < V_{rest} < E_{Na} < E_{Ca} .
```

The resting potential is usually in the range $-60 mV$ to $-70 mV$.
Again, this value is the result of the equilibrium between the ion flow
through the channels and the active ion transport.

(modeling-voltage-gated-ion-channel-conductances)=

### Modeling Voltage-Gated Ion Channel Conductances

Individual ion channels are controlled by gates that switch the channels
between open and closed states.

```{figure} ../figures/chap_02/images/gates.pdf
:name: fig:sodiumC
:width: 100%
Voltage sensors open activation gates and allow selective ions to flow
through the channel according to their electro-chemical gradients. The
inactivation gate blocks the channel.
```

The gates might be modulated by (i) the membrane potential, (ii)
intracellular agents (e.g., second messengers), and (iii) extracellular
agents (e.g., neurotransmitters). {numref}`fig:sodiumC` depicts an
example of voltage controlled $Na^{+}$ channels. These channels are said
to be voltage-gated. Gates either activate, that is open channels, or,
inactivate or close them (see {numref}`fig:sodiumC`).

(modeling-voltage-gated-ion-channels)=

#### Modeling Voltage-Gated Ion Channels

The current $I_i$ generated by an ensemble of (a large number of) the
same ion channels types (say $\textit{Na}^+$ or $K^+$) can be written as

```{math} 
I_i = \bar{g}_i p_i (V-E_i),
```
where $p_i$ is the average proportion of channels in the open state,
$\bar{g}_i$ is the maximal conductance of the population and $E_i$ is
the Nernst equilibrium potential. In what follows we will show how
Hodgkin and Huxley identified the analytical form of the potassium and
sodium channels.

(the-potassium-voltage-gated-channel)=

#### The Potassium Voltage-Gated Channel

As already mentioned, the total $K^+$ current amounts to

```{math} 
I_K=g_K (V-E_K),
```
where the positive parameter $g_K$ is the conductance and $(V-E_K)$ is
the driving force.

````{panels} 
```{figure} ../figures/chap_02/figures/voltage.pdf
:width: 100%

```

---
```{figure} ../figures/chap_02/figures/potassium.pdf
:width: 100%

```

````

Hodgkin and Huxley postulated that the conductance of the potassium
channel is of the form

```{math} 
g_K = \bar{g}_K n^a (t; V),
```
where $\bar{g}_K$ denotes the maximum conductance of the potassium ion
channel, $a$ is an integer exponent and, furthermore, $n$ is the voltage
gated *activation variable* given by

```{math} 
:label: eq:pcond

\frac{dn}{dt} =-\frac{1}{\tau_{n} (V(t))}[n-n_{\infty}(V(t))] .

```
Hodgkin and Huxley found the exponent $a$, and the functional forms of
$n_{\infty}$ and $\tau_{n}$ via a combination of theory and experiment.
A brief overview of the methodology they employed is given below.

First, Hodgkin and Huxley chemically disabled all ion currents except
the potassium current. Then, using the voltage clamp (see
{ref}`sec:clamp` for more details), they kept the membrane potential
fixed at some prestep (holding) potential value $V_{h}$ and then stepped
it to a new value $V_c$ (command voltage). Examples of command voltage
values are depicted in {numref}`fig:clampP`.

After measuring the potassium current intensity values at times
$(t_j), j=1,2,...,N$, the resulting conductance values amount to (by
abuse of notation)

```{math} 
g_K(t_j;(V_{h},V_c))= I_K (t_j)/(V_c-E_K).
```

```{figure} ../figures/chap_02/figures/fig-2.png
:name: fig:Kfit
:width: 100%
Minimizing the quadratic sum in [](eq:optK) with $n_{\infty}$ and
$\tau_n$ known: $\bar{g}_{K}=36$ and $a=4$.
```

Note also that given the *postulated* form of the activation variable
and $n(0; V_h)=n_{\infty}(V_{h})$, the solution to the equation
[](eq:pcond) (again, by abuse of notation) amounts to

```{math} 
n(t;(V_{h},V_c)) = n_{\infty}(V_{h})-(n_{\infty}(V_{h})-n_{\infty}(V_c))(1-\exp(-\frac{t}{\tau_{n}(V_c)})) .
```
The parameters $\bar{g}_K$, $n_{\infty}$ and $\tau_{n}$ can be
determined by minimizing (for fixed $a$) the quadratic sum

```{math} 
:label: eq:optK

\sum_{(V_{h},V_c)} \sum_{j=1}^N
| \bar{g}_K [n_{\infty}(V_{c})+(n_{\infty}(V_{h})-n_{\infty}(V_c))\exp(-\frac{t_j}{\tau_{n}(V_c)})]^a-
g_K(t_j;(V_{h},V_c)) |^2 ,

```
where the outer sum is over all pairings of $V_{h}$ and $V_c$. The power
$a$ is chosen such that the quadratic sum is further minimized.

Hodgkin and Huxley determined the maximum conductance value
($\bar{g}_K = 36 ~[ms/cm^2]$) and the functional form of $n_{\infty}$
and $\tau_n$ (depicted in {numref}`fig:gfunctions`). $a=4$ yielded the
smallest misfit. Since the high-dimensionality of the quadratic sum in
[](eq:optK) can not be gainfully depicted, and to provide a bit of
intuition, we assume in what follows that $n_{\infty}$ and $\tau_n$
minimizing the quadratic sum in [](eq:optK) have been obtained for fixed
$\bar{g}_K$ and $a$. The result of the minimization (the MSE) is a
function of $\bar{g}_K$ and $a$ as shown in {numref}`fig:Kfit`. The
remaining minimization procedure for finding these two parameters is now
straightforward.

(the-sodium-voltage-gated-channel)=

#### The Sodium Voltage-Gated Channel

As mentioned before, the total $\textit{Na}^+$ current is given by the
RHS of

```{math} 
I_{Na}=g_{Na} (V-E_{Na}),
```
where the positive parameter $g_{Na}$ denotes the conductance and
$(V-E_{Na})$ is the driving force. With only the sodium current present
(the current associated with the other ions chemically disabled), the
sodium conductance quickly goes up and then falls off (see
{numref}`fig:clampN`).

````{panels} 
```{figure} ../figures/chap_02/figures/voltage.pdf
:width: 100%

```

---
```{figure} ../figures/chap_02/figures/sodium.pdf
:width: 100%

```

````

Hodgkin and Huxley postulated that the sodium conductance can be modeled
with two voltage gated variables. The probability of an activation gate
to be in the open state is denoted by $m$ and the probability of an
inactivation gate to be in the open state is denoted by $h$. The
proportion of open channels in a large population is $m^a h^b$, where
$a$ is the number of activation gates and $b$ is the number of
inactivation gates per channel. The conductance takes the form

```{math} 
g_{Na}=\bar{g}_{Na} m^a (t;V) h^b (t;V)
```
with

```{math} 
\frac{dm}{dt} =-\frac{1}{\tau_{m} (V)}[m-m_{\infty}(V)]
~~~\text{and}~~~
\frac{dh}{dt} =-\frac{1}{\tau_{h} (V)}[h-h_{\infty}(V)].
```
As before, by abuse of notation

```{math} 
\begin{split}
m(t;(V_{h},V_c)) &= m_{\infty}(V_{h})-(m_{\infty}(V_{h})-m_{\infty}(V_c))(1-\exp(-\frac{t}{\tau_{m}(V_c)})) \\
h(t;(V_{h},V_c)) &= h_{\infty}(V_{h})-(h_{\infty}(V_{h})-h_{\infty}(V_c))(1-\exp(-\frac{t}{\tau_{h}(V_c)})) .
\end{split}
```
Finally, the activation and inactivation variables are obtained by
minimizing the quadratic sum

```{math} 
:label: eq:optNa

\sum_{(V_{h},V_c)} \sum_{j=1}^N
| \bar{g}_{Na} m^a(t_j;(V_h,V_c)) h^b (t_j;(V_h,V_c)) -
g_{Na}(t_j;(V_{h},V_c)) |^2 .

```
Hodgkin-Huxley determined the maximum conductance value
($\bar{g}_{Na} = 120 ~[mS/cm^2]$) and the activation functions,
$m_{\infty}$ and $\tau_m$, and the inactivation functions, $h_{\infty}$
and $\tau_h$ shown in {numref}`fig:gfunctions`. $a=3$ and $b=1$ yielded
the smallest misfit.

Again, to provide a bit of intuition, we assume in what follows that
$m_{\infty}$, $\tau_m$ and $h_{\infty}$, $\tau_h$ minimizing the
quadratic sum in [](eq:optNa) have been obtained for fixed
$\bar{g}_{Na}$ and $a$, with $b=1$. The result of the minimization (the
MSE) is a function of $\bar{g}_{Na}$ and $a$ as shown in
{numref}`fig:Nafit`. As in the case of the potassium channel
conductance, the remaining minimization procedure for finding these two
parameters is now straightforward.

```{figure} ../figures/chap_02/figures/fig-3.png
:name: fig:Nafit
:width: 100%
Minimizing the quadratic sum in [](eq:optNa) with the activation
functions, $m_{\infty}$ and $\tau_m$, and the inactivation functions,
$h_{\infty}$ and $\tau_h$, known. Best fit is obtained for:
$\bar{g}_{Na}= 120$ and $a=3$ (with $b=1$).
```

```{figure} ../figures/chap_02/figures/fig1.pdf
:name: fig:gfunctions
:width: 100%
The form of (left) the gating functions $m_{\infty}, n_{\infty}$, and
$h_{\infty}$ versus membrane voltage and (right) the time constants
$\tau_m$, $\tau_n$ and $\tau_h$ versus membrane voltage.
```

(sec:hhe)=

### The Hodgkin-Huxley Equations

Concluding, Hodgkin and Huxley determined that in the squid axon (i) the
potassium current is carried by voltage-gated channels with four
activation gates, (ii) the sodium current is carried by voltage-gated
channels with three activation gates and one inactivation gate, (iii) a
chloride current is carried by Ohmic (leak) channels.

The complete set of equations is given by the system of differential
equations

```{math} 
\begin{split}
C \frac{dV}{dt} &= -\bar{g}_{Na}m^{3}h(V-E_{Na})-\bar{g}_{K}n^{4}(V-E_{K})-g_{L}(V-E_{L})
+I(t) \\
\frac{dm}{dt} &=-\frac{1}{\tau_{m} (V)}[m-m_{\infty}(V)] \\
\frac{dh}{dt} &=-\frac{1}{\tau_{h} (V)}[h-h_{\infty}(V)] \\
\frac{dn}{dt} &=-\frac{1}{\tau_{n} (V)}[n-n_{\infty}(V)] ,\\
\end{split}
```
where $\bar{g}_{Na}$ and $\bar{g}_{K}$ are the maximum conductance
values of the sodium and potassium channels, respectively. $g_{L}$ is
the value of the leak conductance. The variable $n$ describes the
activation of the potassium channel. The variables $m$ and $h$ describe
the activation and inactivation of the sodium channel, respectively.

```{prf:remark} 
*Note that the input to the HHN is the injected current $I=I(t)$ and the
output is the membrane voltage $V=V(t)$ for all $t \geq t_0$. While
information about the membrane voltage may be received by an upstream
neuron, information about the gating variables $(m,h,n)$ is not provided
to an upstream "receiver" (neuron).*
```

```{figure} ../figures/chap_02/figures/fig2.pdf
:name: fig:4states
:width: 90%
Membrane voltage $V$ (red), currents $I_K$ (blue), $I_{Na}$ (green) and
$I_L$ (cyan).
```

The membrane potential and the three ion channel currents are shown in
{numref}`fig:4states`. The shape of the spike generated by the
Hodgkin-Huxley neuron is shown in {numref}`fig:spikeshape`. The initial
rapid upstroke is caused by the $Na^+$-mediated inward current. As the
membrane voltage moves towards $E_{Na}$, the slower gating variables $h$
and $n$ catch up causing inactivation of $\textit{Na}^+$ and activation
of outward $K^+$ current, respectively. The outward $K^+$ current
continues to be activated even after the action potential downstroke,
thereby causing the membrane voltage to go toward $E_K$ below its
resting potential. In addition, the $\textit{Na}^+$ current continues to
be inactivated and is not available during an absolute refractory
period. See also {numref}`fig:4states`.

{numref}`fig:dc` shows the response of the Hodgkin-Huxley neuron to two
different DC (constant) injected currents.

(gate-model-underlying-the-hodgkin-huxley-equations)=

### Gate Model Underlying the Hodgkin-Huxley Equations

```{figure} ../figures/chap_02/figures/fig2b.pdf
:name: fig:spikeshape
:width: 100%
The Hodgkin-Huxley neuron model predicts the shape of the spikes.
```

```{figure} ../figures/chap_02/figures/fig3
:name: fig:dc
:width: 100%
The effect of the injected current (a) lower and (b) higher DC value of
the injected current.
```

As already mentioned, the ion channels undergo a conformational change
in response to variations of the electric field. This conformational
change causes the channel to move from open to closed states and vice
versa. The open/closed dynamics are highlighted by the simple
transformation

```{math} 
\alpha_{l}=l_{\infty}/\tau_{l}, ~~~~~~
\beta_{l}=(1-l_{\infty})/\tau_{l}
```
for all $l, l = h, m, n$. This transformation leads to the gate model of
the Hodgkin-Huxley neuron with the explicit dynamics:

```{math} 
\begin{split}
C \frac{dV}{dt} &= -\bar{g}_{Na}m^{3}h(V-E_{Na})-\bar{g}_{K}n^{4}(V-E_{K})-g_{L}(V-E_{L})
+I(t) \\
\frac{dm}{dt} &=\alpha_{m} (1-m) - \beta_{m} m \\
\frac{dh}{dt} &= \alpha_{h} (1-h) - \beta_{h} h\\
\frac{dn}{dt} &= \alpha_{n} (1-n) - \beta_{n} n.\\
\end{split}
```
Hodgkin and Huxley interpolated $\alpha_{l}$ and $\beta_{l}$,
$l=h, m, n$, as combinations of exponential functions of transmembrane
voltage and found:

```{math} 
\begin{split}
\alpha_{n}(V) &=0.01(10-V)/(e^{\frac{10-V}{10}}-1) , \\
\beta_{n}(V) &=0.125 ~e^{\frac{-V}{80}}
\end{split}
```
and

```{math} 
\begin{split}
\alpha_{m}(V) &=0.1(25-V)/(e^{\frac{25-V}{10}}-1) , \\
\beta_{m}(V) &= 4 e^{\frac{-V}{18}}
\end{split}
```
and finally

```{math} 
\begin{split}
\alpha_{h}(V) &=0.07 e^{\frac{-V}{20}} , \\
\beta_{h}(V) &= 1/ (e^{\frac{30-V}{10}} +1) .
\end{split}
```
These parameters, first provided by Hodgkin-Huxley, correspond to the
membrane potential shifted by 65 mV so that the resting potential is
zero. The shifted Nernst potentials are $E_K= -12$ mV, $E_{Na}=120$ mV
and $E_L=10.6$ mV. Note that this shift, introduced for the sake of
convenience, has led to substantial confusion over the years.

Concluding:

-   $\alpha_l (V)$ and $\beta_l (V)$, $l=m,h,n,$ are the rate
    coefficients associated with the closed and open states,
    respectively,

-   the reaction between open and closed states is a first-order
    reaction.

(sec:clamp)=

## The Voltage Clamp

```{figure} ../figures/chap_02/images/clamp.pdf
:name: fig:vclamp
:width: 90%
The voltage clamp for measuring membrane currents of the giant squid
axon.
```

The voltage clamp (see {numref}`fig:vclamp`) was the key experimental
tool used by Hodgkin and Huxley to reveal the ionic mechanisms
underlying the generation of action potentials in the squid giant axon.
The voltage clamp experiments in the squid axon enabled the estimation
of the instantaneous conductances without the influence of
voltage-dependent parameters. The voltage clamp permits the experimenter
to "clamp" the membrane potential at predetermined levels.

A schematic of the voltage clamp techniques is shown in
{numref}`fig:vclamp`. In the saline solution of a bath, the squid axon
is immersed. The axon contains two electrodes: a recording and a current
passing electrode. The recording electrode measures the membrane
potential and it is connected to the voltage clamp amplifier. The
voltage clamp amplifier compares the membrane potential to the desired
command voltage (potential). When the membrane voltage is different from
the command potential, the clamp amplifier injects current into the axon
through a second electrode. This feedback arrangement causes the
membrane potential to become the same as the command potential. The
current flowing back into the axon, and thus across it's membrane, is
measured and used for evaluating the value of the ion channel
conductance.

Note that, by inserting a wire into the squid axon, the membrane voltage
value along the axon patch was constant and, therefore, a *space clamp*
also holds. Second, by using a *voltage clamp*, the capacitive current
had the value zero. The voltage gated ion channels continue to open or
close in response to changes in membrane potential, but the voltage
clamp prevents the resultant changes in membrane current to influence
the membrane potential.

(sec:reduced)=

## The Geometry of the Hodgkin-Huxley Models

The behavior of high-dimensional differential equations is difficult to
visualize - and even more difficult to analyze. Three- or
two-dimensional differential equations, however, can be studied in a
transparent manner by means of "phase plane" analysis. A reduction of
the four-dimensional equation of Hodgkin and Huxley to a three- or
two-variable neuron model is, therefore, highly desirable.

(a-3d-reduced-hodgkin-huxley-neuron-model)=

### A 3D Reduced Hodgkin-Huxley Neuron Model

The Hodgkin-Huxley equations can be simplified by noting that $\tau_{m}$
only takes small values. Assuming that the gating variable $m$ quickly
achieves its steady state value, i.e., $m = m_{\infty}(V)$, we obtain

```{math} 
\begin{split}
C \frac{dV}{dt} &= -\bar{g}_{Na}m_{\infty}^{3}h(V-E_{Na})-\bar{g}_{K}n^{4}(V-E_{K})-g_{L}(V-E_{L})
+I(t) \\
%\frac{dm}{dt} &=-\frac{1}{\tau_{m} (V)}[m-m_{\infty}(V)] \\
\frac{dh}{dt} &=-\frac{1}{\tau_{h} (V)}[h-h_{\infty}(V)] \\
\frac{dn}{dt} &=-\frac{1}{\tau_{n} (V)}[n-n_{\infty}(V)] .\\
\end{split}
```
Thus, the HH equations consist now of 3 equations with 3 unknowns. The
phase space can be easily plotted. See {numref}`fig:vnh`.

```{figure} ../figures/chap_02/figures/3D-Cycle.png
:name: fig:vnh
:width: 100%
The visualization of the essential dynamics of the 3D reduced
Hodgkin-Huxley neuron model in the phase plane. Left: voltage trace of
the HH neuron as a function of time. Right: $(V,n,h)$ 3D phase
representation (no time variable).
```

(a-2d-reduced-hodgkin-huxley-neuron-model)=

### A 2D Reduced Hodgkin-Huxley Neuron Model

The Hodgkin-Huxley equations can be further simplified by observing that
the rate of inactivation of $Na^{+}$ channels is nearly reciprocal to
the rate of activation of $K^{+}$ channels, and therefore, $h=1-n$.
Thus, the Hodgkin-Huxley equations can be reduced to:

```{math} 
\begin{split}
C \frac{dV}{dt} &= - \bar{g}_{Na} m_{\infty}^{3}(V)(1-R)(V-E_{Na}) - \bar{g}_{K} R^{4} (V-E_{K}) -g_{leak}(V-E_{leak}) + I(t) \\
\tau_{R} \frac{dR}{dt} &= -[R-R_{\infty}(V)]; ~~~
\tau_{R} =1+5 \exp[\frac{-(V+60)^{2}}{55^{2}}].
\end{split}
```

```{figure} ../figures/chap_02/figures/fig4.pdf
:name: fig:rinzel
:width: 100%
Visualization of the spiking behavior and the phase plane representation
of the Rinzel neuron model.
```

Here, $R$ describes the $K^{+}$ channel opening and $Na^{+}$ channel
closing, which together constitute the recovery variable. The explicit
expressions for $m_{\infty}$ and $R_{\infty}$ are two complex to provide
much analytical insight. The 2D reduced Hodgkin-Huxley model described
above is also known in the literature as the Rinzel neuron model. For a
visualization and phase plane representation, see {numref}`fig:rinzel`.

(appendix)=

## Appendix

(the-current-and-dynamic-clamp)=

### The Current and Dynamic Clamp

**The Current Clamp** is closely related to the voltage clamp. The
difference is that while the value of the voltage is continuously
monitored, the value of the injected current is kept fixed. By keeping
the value of the current constant, however, the voltage value is now
variable. The current clamp is realized with a circuit with an
adjustable impedance whose value multiplied with the (constant) injected
current amounts to the value of the measured voltage.

**The Dynamic Clamp** is a real-time feedback control systems that
functionally replaces a biological conductance (group of ion channels)
with a virtual conductance. The virtual or programmable conductance
functionally depends on the membrane voltage. The value of the injected
current is the product of the desired conductance value and the driving
force. The latter is the difference between the membrane potential and
the reverse potential. This is to be contrasted with the voltage or
current clamp recordings whereby a current is injected into the neuron
and the membrane voltage is simultaneously measured. The dynamic clamp
enables the emulation of (i) voltage-independent conductances, (ii)
voltage-dependent conductances, (iii) synapses between neurons, (iii)
biological-silicon hybrid circuits, and (iv) in-vivo synaptic input.

```{figure} ../figures/chap_02/circuits/dclamp.png
:name: fig:dclamp
:width: 45%
Dynamic clamp for the Hodgkin-Huxley neuron with injected conductance
$g_{MC}$.
```

As with the traditional current and voltage clamp techniques,
limitations in applying the dynamic clamp are due to imperfections of
the electrode resistance and capacitance. These imperfections can be
minimized by using low-resistance electrodes, by using separate
electrodes for voltage recording and current injection, or by temporally
separating recording and injection through a single electrode using the
discontinuous (switched) current clamp technique. The voltage
measurement error is proportional to the amount of current flowing
through the nanoactuator. Compensation methods to reduce this error have
been developed.

(the-wilson-neuron-model-a-2d-reduced-hhn)=

### The Wilson Neuron Model: A 2D Reduced HHN

Wilson proposed a set of reduced Hodgkin-Huxley equations of the form:

```{math} 
\begin{split}
C \frac{dV}{dt} &= - \bar{g}_{Na}(V) (V-E_{Na}) - R (V-E_{K}) + I(t) \\
\tau_{R} \frac{dR}{dt} &= -[R-R_{\infty}(V)]
\end{split}
```
Here, $R$ describes the recovery of the membrane potential.

```{figure} ../figures/chap_02/figures/fig5.pdf
:name: fig:wilson
:width: 100%
Wilson neuron model: spiking behavior and phase plane.
```

By restricting $g_{Na}(V)$ to a quadratic polynomial and $R_{\infty}(V)$
to a quadratic term, the following explicit formulation is obtained:

```{math} 
\begin{split}
C \frac{dV}{dt} &= - (17.81+47.71 V + 32.63 V^{2})(V-0.55)-\\
&~~~~ - 26.0 R(V+0.92) + I(t) \\
\tau_{R} \frac{dR}{dt} &= -R + 1.35 V + 1.03 ,
\end{split}
```
where the capacitance $C=1 \mu$F/cm$^{2}$ and $\tau_{R}=1.9$ms. As the
simulations show (see {numref}`fig:wilson`), the reduced set of equation
above behave to a large extent in the same way as the Hodgkin-Huxley
equations.

Note that by adding a sinusoidal component to the stimulus current:

```{math} 
\begin{split}
C \frac{dV}{dt} &= - (17.81+47.71 V + 32.63 V^{2})(V-0.55)-\\
&~~~~ - 26.0 R(V+0.92) + I(t) \\
\tau_{R} \frac{dR}{dt} &= -R + 1.35 V + 1.03 \\
I(t) &= I_{0}+ A \sin(2\pi \omega t)
\end{split}
```
the behavior of the reduced Hodgkin-Huxley equations leads to chaos (see
{numref}`fig:chaos`).

```{figure} ../figures/chap_02/figures/fig6.pdf
:name: fig:chaos
:width: 100%
Wilson neuron model exhibiting chaos: spiking behavior and phase plane.
```

(nonlinear-oscillations-and-limit-cycles)=

### Nonlinear Oscillations and Limit Cycles

This section gives a flavor of some elementary theoretical
considerations arising in nonlinear systems. The field itself is vast.

(what-is-an-oscillation)=

#### What is an Oscillation?

A system oscilates when it has a nontrivial periodic solution

```{math} 
{\bf x}(t+T)= {\bf x}(t),
```
for all $t \in {\mathbb  R}_{+}$ for some $T>0$. Here ${\bf x}$ is a
vector of appropriate dimension and $T$ is the period of the
oscillation.

Nonlinear oscillations or rythms are ubiquitous in living organisms and
arise as circadian rhythms, cardiac rhythms, hormonal cycles, the
rhythms of breathing and locomotion.

(fundamental-problems-with-linear-oscillations)=

#### Fundamental Problems with Linear Oscillations

In linear systems the only possible oscillations involve sines and
cosines. There are two fundamental problems with linear oscillators (i)
the linear oscillator is structurally not stable (not robust) and (ii)
the amplitude of the oscillation depends on the initial conditions. In
addition, noise could alter the amplitude of the linear oscillation.
These fundamental problems can be eliminated in nonlinear oscillators.
For this reason alone, it is safe to say that biological rhythms have
evolved to be inherently nonlinear. The generation of action potentials
in single neurons is the result of inherently nonlinear oscillations.

(the-poincaré-bendixon-theorem)=

#### The Poincaré-Bendixon Theorem

The limiting behavior of nonlinear oscillations is, in general, hard to
visualize and to derive. For nonlinear differential equations the
problem is not completely understood. The planar case, however, is
intuitively simple.

```{prf:definition} Limit Cycles
(Limit Cycles). *An oscillatory trajectory in the state space of a
nonlinear system is a **limit cycle** if all trajectories in a
sufficiently small region enclosing the trajectory are spirals. If these
neighboring trajectories spiral towards the limit cycle as
$t \rightarrow \infty$, then the limit cycle is **asymptotically
stable**. If, however, neighboring trajectories spiral away from the
limit cycle as $t \rightarrow \infty$, the limit cycle is **unstable**.*
```

```{prf:theorem} Poincaré-Bendixon
(Poincaré-Bendixon). *Bounded trajectories in the plane will have to
approach periodic orbits or equilibrium points as time goes to
infinity.*
```

```{prf:example} The Van der Pool Oscillator
(The Van der Pool Oscillator). *The Van der Pool relaxation oscillator
considered here is described by:

```{math} 
\begin{split}
dx_{1}/{dt} &= x_{2} \\
dx_{2}/{dt} &=\beta(1-x_{1}^{2})x_{2}-\alpha^{2} x_{1}
\end{split}
```
For $\alpha=500$ and $\beta=0.5$ this non-linear system of equations has
a periodic attractor. See also {numref}`fig:vdp`.*
```

```{prf:remark} 
*The Van der Pool oscillator and the reduced Hodgkin-Huxley neuron are
central to the study of oscillators arising in physics and engineering
and, neuroscience, respectively. Their study in the phase plane shows
that they exhibit limit cycles. This common characteristic is a bridge
between seemingly disparate fields. We shall build upon it.*
```

```{figure} ../figures/chap_02/figures/fig7.png
:name: fig:vdp
:width: 100%
Van der Pool oscillator: spiking behavior and phase plane.
```
